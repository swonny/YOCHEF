<!DOCTYPE html>
<html lang="en">

{% load static %}

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="셰프가 있는 곳이 식당이다, YOCHEF"> 
    <meta property="og:type" content="website"> 
    <meta property="og:url" content="http://yochef.site"> 
    <meta property="og:image" content="{% static 'image/og_meta_yochef1.png' %}">
    <meta property="og:description" content="한국 최초 출장요리 플랫폼 yochef">
    {% load static %}
    <title>YOCHEF</title>
    <link rel="stylesheet" href="{% static 'css/base.css' %}" type="text/css">
    <link rel="shortcut icon" href="{% static 'image/favicon.ico' %}" type="image/x-icon">
    {% block style %}
    {% endblock %}
</head>
<body>
  <!-- 네브바 -->
  <nav class="nav-container">
    <div>
      <div class="nav__left-container">
        <div class="nav__item yochef"><a href="{% url 'main' %}">YOCHEF</a></div>
        <!-- <a href="{% url 'main' %}"><img class="logo" src="{% static 'image/navlogo.png' %}" alt=""></a> -->
      </div>
      <!-- 로그인 상태라면 -->
      {% if user.is_authenticated %}
        <!-- 셰프등록 돼있다면 -->
        {% if user.customer.isChef %}
          <!-- 셰프버전이라면 -->
          {% if user.customer.currentVer == 1 %}
          <!-- <ul class="nav__item-container nav--middle">
            <li class="nav__item"><a href="{% url 'editChefProfile' %}">셰프 정보 관리</a></li>
            <li class="nav__item"><a href="{% url 'logout' %}">로그아웃</a></li>
          </ul> -->
          <div class="nav__item-wrapper nav--right">
            <li class="nav__item"><a href="{% url 'mypage' %}">{{user.customer.name}} 셰프님</a></li>
            <li class="nav__item"><a href="{% url 'editChefProfile' %}">셰프 정보 관리</a></li>
            <li class="nav__item"><a href="{% url 'logout' %}">로그아웃</a></li>
            <div class="button-wrapper">
              <a href="{% url 'changePageVer' %}"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDUxMS45OTkgNTExLjk5OSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+Cgk8Zz4KCQk8cGF0aCBkPSJNMzc2LjQ5OSwxMjAuNWgtMjQxQzYwLjc4NCwxMjAuNSwwLDE4MS4yODYsMCwyNTZzNjAuNzg0LDEzNS41LDEzNS40OTksMTM1LjVoMjQxYzc0LjcxNSwwLDEzNS41LTYwLjc4NSwxMzUuNS0xMzUuNSAgICBTNDUxLjIxNCwxMjAuNSwzNzYuNDk5LDEyMC41eiBNMTM1LjQ5OSwzNjEuNTAxQzc3LjMyNiwzNjEuNTAxLDMwLDMxNC4xNzMsMzAsMjU2YzAtNTguMTczLDQ3LjMyNi0xMDUuNSwxMDUuNDk5LTEwNS41ICAgIGM1OC4xNzMsMCwxMDUuNSw0Ny4zMjcsMTA1LjUsMTA1LjVDMjQwLjk5OSwzMTQuMTczLDE5My42NzIsMzYxLjUwMSwxMzUuNDk5LDM2MS41MDF6IiBmaWxsPSIjYmQwMDAwIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBzdHlsZT0iIj48L3BhdGg+Cgk8L2c+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPC9nPjwvc3ZnPg==" /></a>
              <div class="chef-button-describe">셰프</div>
            </div>
          </div>
          <!-- 셰프등록 o & 손님버전이라면 -->
          {% else %}
          <div class="nav__item-wrapper nav--right">
            <li class="nav__item"><a href="{% url 'mypage' %}">{{user.customer.name}} 님</a></li>
            <li class="nav__item"><a href="{% url 'mymenuReservation' %}">마이메뉴</a></li> <!-- 백 작업 위해 임의로 url 연결했습니다-->
            <li class="nav__item"><a>쿠폰함</a></li>
            <li class="nav__item"><a href="{% url 'logout' %}">로그아웃</a></li>
            <div class="button-wrapper">
              <a href="{% url 'changePageVer' %}"><img id="customer--button" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDUxMS45OTkgNTExLjk5OSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+Cgk8Zz4KCQk8cGF0aCBkPSJNMzc2LjQ5OSwxMjAuNWgtMjQxQzYwLjc4NCwxMjAuNSwwLDE4MS4yODYsMCwyNTZzNjAuNzg0LDEzNS41LDEzNS40OTksMTM1LjVoMjQxYzc0LjcxNSwwLDEzNS41LTYwLjc4NSwxMzUuNS0xMzUuNSAgICBTNDUxLjIxNCwxMjAuNSwzNzYuNDk5LDEyMC41eiBNMTM1LjQ5OSwzNjEuNTAxQzc3LjMyNiwzNjEuNTAxLDMwLDMxNC4xNzMsMzAsMjU2YzAtNTguMTczLDQ3LjMyNi0xMDUuNSwxMDUuNDk5LTEwNS41ICAgIGM1OC4xNzMsMCwxMDUuNSw0Ny4zMjcsMTA1LjUsMTA1LjVDMjQwLjk5OSwzMTQuMTczLDE5My42NzIsMzYxLjUwMSwxMzUuNDk5LDM2MS41MDF6IiBmaWxsPSIjYmQwMDAwIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBzdHlsZT0iIj48L3BhdGg+Cgk8L2c+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPC9nPjwvc3ZnPg==" /></a>
              <div class="customer-button-describe">손님</div>
            </div>
          </div>
          <!-- 쿠폰/포인트함 -->
          <div class="coupon_point_box close">
            <p>적립 혜택</p>
            <div class="box_tab">
              <div class="box_tab__coupon selected">쿠폰</div>
              <div class="box_tab__point">포인트</div>
            </div>
            <div class="coupon_box open">
              <!-- 쿠폰 코드 관련 내용 임시 삭제 -->
              <!-- <form action="" method="POST">
                    <input type="text" name="couponCode" placeholder="쿠폰 코드를 입력해주세요">
                    <input type="submit" value="등록하기">
              </form>   -->
              <div class="coupon_box__detail">
                <p>사용 가능한 쿠폰 <span>{{coupons.count|default:'0'}}장</span></p>
              </div>
              <div class="coupon_box__notice">
                <div><span>**</span><p>쿠폰 사용 약관을 꼭 숙지해주세요!</p></div>
                <div><span>-</span><p>쿠폰은 예약 당 1장만 사용이 가능합니다.</p></div>
                <div><span>-</span><p>유효기간 내에 반드시 사용해야 하며, 기간 만료 후에는 사용이 불가합니다.쿠폰이 사용된 수업 환불 시, 결제 취소 및 환불 완료 시점에 쿠폰의 유효 기간이 남아있는 경우에만 사용 가능한 상태로 복구 됩니다.</p></div>
                <div><span>-</span><p>쿠폰 금액이 결제 금액을 초과하는 경우, 차액은 반환되지 않습니다. </p></div>
              </div>
            </div>
            <div class="point_box close">
              <div class="point_box__detail">
                <p>보유 포인트 <span>{{request.user.customer.point}}P</span></p>
                <div class="point_box__detial__notice">
                  <p>셰프가 준비한 프로그램의 리뷰를 작성하시면 포인트를 적립할 수 
                    있어요!</p>
                  <p>[ 텍스트 리뷰 500P ]</p>
                </div>
              </div>
            </div>
          </div>
          <!-- // 쿠폰/포인트함 -->
          {% endif %}
        <!-- 셰프등록 안돼있다면 -->
        {% else %}
        <ul class="nav__item-wrapper nav--right">
          <a class="nav__item" href="{% url 'mypage' %}">{{user.customer.name}} 님</a>
          <li class="nav__item"><a href="{% url 'mymenuReservation' %}">마이메뉴</a></li>
          <li class="nav__item" value=0><a>쿠폰함</a></li>
          <li class="nav__item"><a href="{% url 'registerChef' '1' %}">셰프등록</a></li>
          <li class="nav__item"><a href="{% url 'logout' %}">로그아웃</a></li>
        </ul>
        {% endif %}
      <!-- 로그아웃 상태라면 -->
      {% else %}
      <ul class="nav__item-wrapper nav--right">
        <li class="nav__item"></li>
        <li class="nav__item"></li>
        <li class="nav__item"><a  href="{% url 'signup' %}">회원가입</a></li>
        <li class="nav__item"><a href="{% url 'login' %}">로그인</a></li>
      </ul>
      {% endif %}
    </div>
  </nav>   
  <!-- // 네브바 -->

  <!-- 카테고리 네브바 -->
  <nav class="main-category-container">
    <ul id="octagon" class="main-category-item-container">
        <li class="main-category-item"><a href="/postList" class="{% if category == 0 %} currentCategory{% endif %}">전체보기</a></li>
        <li class="main-category-item"><a href="/postList?category=1" class="{% if category == 1 %} currentCategory{% endif %}">뷔페/케이터링</a></li>
        <li class="main-category-item"><a href="/postList?category=2" class="{% if category == 2 %} currentCategory{% endif %}">한식</a></li>
        <li class="main-category-item"><a href="/postList?category=3" class="{% if category == 3 %} currentCategory{% endif %}">일식</a></li>
        <li class="main-category-item"><a href="/postList?category=4" class="{% if category == 4 %} currentCategory{% endif %}">중식</a></li>
        <li class="main-category-item"><a href="/postList?category=5" class="{% if category == 5 %} currentCategory{% endif %}">아시안</a></li>
        <li class="main-category-item"><a href="/postList?category=6" class="{% if category == 6 %} currentCategory{% endif %}">양식</a></li>
        <li class="main-category-item"><a href="/postList?category=7" class="{% if category == 7 %} currentCategory{% endif %}">채식</a></li>
        <li class="main-category-item"><a href="/postList?category=8" class="{% if category == 8 %} currentCategory{% endif %}">기타</a></li>
    </ul>
  </nav>
  <!-- // 카테고리 네브바 -->

  <!-- 내용 -->
  <div style="margin-bottom: 100px;" class="contents">
    {% block content %}
    {% endblock %}
  </div> 
  <!-- // 내용 -->

  <!-- 푸터 -->
  <footer id="footer">
    <div id="footer-bottom">
      <div class="footer-copyright-part">
        Copyright © 2021 KAU Likelion 9TH Team STANDARD all rights reserved.
        <br>
      </div>
      <p class="team-name">기획 및 개발 : 블루, 워니, 제우스, 키위</p>
    </div>
  </footer>
  <!-- // 푸터  -->

</body>
<script src="{% static 'js/common.js' %}"></script>
<script>
  
  /*const logo = document.getElementsByClassName('logo');
  const yochef = document.getElementsByClassName('yochef');
  
  if ( window.location.pathname == '/' ) {
    logo[0].classList.toggle('hidden');
  } else {
    yochef[0].classList.toggle('hidden');
  }*/

  // redirect
  if (window.location.href.includes("http://3.36.156.211")){
    location.href = "http://yochef.site/";
  }

  // 쿠폰함 
  let checkChild = (e, target) => { 
    if (e == target){ return true }
    else if (e.hasChildNodes){
      for (element of e.children) {
          if (checkChild(element, target)){ return true }
      };
    }
    return false;
  }
  
  document.addEventListener("mouseup", function (e){
    let couponBox = document.querySelector("div.coupon_point_box");
    if (couponBox == null) {return;}
    if(!checkChild(couponBox, e.target)){
      couponBox.classList.remove("open");
      couponBox.classList.add("close");
    }
  });

  let setCoupon = (data) => {
    document.querySelector("div.coupon_box__detail").innerHTML = "";
    let coupons = data['coupons']
    let couponBox = "<p>사용 가능한 쿠폰 <span></span></p>";
    let availableCoupon = 0;
    for (coupon of coupons){
      couponBox += `
        <div>
          <div class="coupon__title">
            <p>${coupon.coupon__title}</p>`
      if (coupon.isUsed) {
        couponBox += `<p>사용 완료  </p>`;
      }else{
        availableCoupon++;
        couponBox += `<p>${coupon.coupon__validDate.substring(0, 10)} 까지</p>`
      }
      couponBox += `
        </div>
          <div class="coupon__detail">
            <p>${coupon.coupon__description}</p>
            <p>${coupon.coupon__offrate} %</p>
          </div>
        </div>
      `
    }
    document.querySelector("div.coupon_box__detail").innerHTML += couponBox;
    document.querySelector("div.coupon_box__detail > p > span").innerHTML = availableCoupon + "장"
  }

  function openCouponBox()  {
    let couponBox = document.querySelector("div.coupon_point_box");
    if (couponBox.value){
      couponBox.value = 0;
      couponBox.classList.replace("open", "close");
    }else{
      couponBox.classList.replace("close", "open");
      couponBox.value = 1;
      sendAjax('POST', '/getCoupon', setCoupon);
    }
  }

  document.querySelector('div.nav__item-wrapper > li.nav__item:nth-child(3)').addEventListener('click', openCouponBox);

  let changeTab  = (e) => {
    e.target.classList.add("selected");
    let couponTab = document.querySelector('div.box_tab > div.box_tab__coupon');
    let pointTab = document.querySelector('div.box_tab > div.box_tab__point');
    if (e.target == couponTab){
      couponTab.classList.add('selected');
      pointTab.classList.remove('selected');
      document.querySelector('div.coupon_box').classList.remove('close');
      document.querySelector('div.point_box').classList.remove('open');
      document.querySelector('div.coupon_box').classList.add('open');
      document.querySelector('div.point_box').classList.add('close');
    }else{
      pointTab.classList.add('selected');
      couponTab.classList.remove('selected');
      document.querySelector('div.coupon_box').classList.remove('open');
      document.querySelector('div.point_box').classList.remove('close');
      document.querySelector('div.coupon_box').classList.add('close');
      document.querySelector('div.point_box').classList.add('open');
    }
  }
  if (document.querySelector('div.box_tab') != null){
    document.querySelector('div.box_tab').addEventListener('click', changeTab);
  }
  
 
  
</script>
{% block scripts %}
{% endblock scripts %}
</html>