{% extends 'base.html' %}
{% load static %}
{% block style %}    <link rel="stylesheet" href="{% static 'css/editChefProfile_2.css' %}">
{% endblock %}
{% block content %}
    <form onsubmit="return formCheck()" name="registerChef_2" method="POST" action="{% url 'registerChef' '3' %}">
    {% csrf_token %}
        <div class="edit-chef-wrapper">
            {% include 'registerChef_side.html' %}
                <div class="edit-content">                
                    <section class="category-region">
                        <article class="register-header">
                            <h3>예약글을 등록해 주세요!</h3>
                            <div class="status-bar-wrapper" style="width: 100%;">
                                <div class="status-bar" style="width: 55%"> </div>
                            </div>
                        </article>

                        <!-- 음식 카테고리 지정 -->
                        <article class="category__wrapper">
                            <h4 class="article-title">카테고리</h4>
                            <select name="category" value="{{post.category|default:''}}">
                                <option value="0">선택하세요.</option>
                                <option value="1">뷔페/케이터링</option>
                                <option value="2">한식</option>
                                <option value="3">일식</option>
                                <option value="4">중식</option>
                                <option value="5">아시안</option>
                                <option value="6">양식</option>
                                <option value="7">채식</option>
                            </select>
                        </article>
                        <!-- // 음식 카테고리 지정 -->

                        <!-- 지역 설정 -->
                        <article class="region-wrapper">
                            <h4 class="article-title article-title--top">지역 선택 </h4>
                            <div id="region-selection-all">
                                <div class="region-selection-wrapper">
                                    <select class="region-selection" value="{{region|default:0}}" name="residence"></select>
                                    <select id="region-detail-selection" value="{{regionDetail|default:0}}" name="residenceDetail"></select>
                                    <!-- 추후구현: 지역추가기능 구현시 필요한 삭제기능
                                    <button type="button" onclick="delRegion(this)" class="delete-region" ><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDQwNyA0MDciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTIiIHhtbDpzcGFjZT0icHJlc2VydmUiIGNsYXNzPSIiPjxnPjxwYXRoIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZD0ibTg5LjE5OTIxOSAzN2MwLTEyLjEzMjgxMiA5LjQ2ODc1LTIxIDIxLjYwMTU2Mi0yMWg4OC44MDA3ODFjMTIuMTI4OTA3IDAgMjEuNTk3NjU3IDguODY3MTg4IDIxLjU5NzY1NyAyMXYyM2gxNnYtMjNjMC0yMC45NTMxMjUtMTYuNjQ0NTMxLTM3LTM3LjU5NzY1Ny0zN2gtODguODAwNzgxYy0yMC45NTMxMjUgMC0zNy42MDE1NjIgMTYuMDQ2ODc1LTM3LjYwMTU2MiAzN3YyM2gxNnptMCAwIiBmaWxsPSIjOTI5MjkyIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBzdHlsZT0iIiBjbGFzcz0iIj48L3BhdGg+PHBhdGggeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkPSJtNjAuNjAxNTYyIDQwN2gxODkuMTk5MjE5YzE4LjI0MjE4OCAwIDMyLjM5ODQzOC0xNi4wNDY4NzUgMzIuMzk4NDM4LTM2di0yNDdoLTI1NHYyNDdjMCAxOS45NTMxMjUgMTQuMTU2MjUgMzYgMzIuNDAyMzQzIDM2em0xNDUuNTk3NjU3LTI0NC44MDA3ODFjMC00LjQxNzk2OSAzLjU4MjAzMS04IDgtOHM4IDMuNTgyMDMxIDggOHYxODljMCA0LjQxNzk2OS0zLjU4MjAzMSA4LTggOHMtOC0zLjU4MjAzMS04LTh6bS01OSAwYzAtNC40MTc5NjkgMy41ODIwMzEtOCA4LThzOCAzLjU4MjAzMSA4IDh2MTg5YzAgNC40MTc5NjktMy41ODIwMzEgOC04IDhzLTgtMy41ODIwMzEtOC04em0tNTkgMGMwLTQuNDE3OTY5IDMuNTgyMDMxLTggOC04czggMy41ODIwMzEgOCA4djE4OWMwIDQuNDE3OTY5LTMuNTgyMDMxIDgtOCA4cy04LTMuNTgyMDMxLTgtOHptMCAwIiBmaWxsPSIjOTI5MjkyIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBzdHlsZT0iIiBjbGFzcz0iIj48L3BhdGg+PHBhdGggeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkPSJtMjAgMTA4aDI3MC4zOTg0MzhjMTEuMDQ2ODc0IDAgMjAtOC45NTMxMjUgMjAtMjBzLTguOTUzMTI2LTIwLTIwLTIwaC0yNzAuMzk4NDM4Yy0xMS4wNDY4NzUgMC0yMCA4Ljk1MzEyNS0yMCAyMHM4Ljk1MzEyNSAyMCAyMCAyMHptMCAwIiBmaWxsPSIjOTI5MjkyIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBzdHlsZT0iIiBjbGFzcz0iIj48L3BhdGg+PC9nPjwvc3ZnPg==" /></button>
                                    추후구현: 지역추가기능 구현시 필요한 삭제기능 -->
                                </div>
                            </div>
                            <!-- 추후구현: 지역 추가
                            <button class="region-add-button" onclick="addRegion(this)" type="button">지역 추가</button>
                            // 추후구현: 지역 추가 -->
                        </article>
                        <!-- // 지역 설정 -->
                    </section>

                    <!-- 이전, 다음 버튼 -->
                    <aside class="button">
                        <button type="submit" class="after-button" id="submitButton">다음</button>
                        <button type="button" class="before-button"><a class="before-button" href="{% url 'registerChef' '1' %}">이전</a></button>
                    </aside>
                    <!-- // 이전, 다음 버튼 -->
            </div>
        </div>
    </form>

{% endblock %}

{% block scripts %}
<script>

    //지역 detail
    document.addEventListener("DOMContentLoaded", () => {
        getRegion(parseInt('{{post.region|default:0}}'));
        getRegionDetail(parseInt('{{post.region|default:1}}'), parseInt('{{post.regionDetail.id|default:0}}'));
    });

    document.getElementsByName('residence')[0].addEventListener('change', (event)=>{
        getRegionDetail(document.getElementsByName('residence')[0].value);
    });

    //form data 모두 등록되었는지 확인
    function formCheck() {

        const category = document.getElementsByName('category')[0].value;

        if(category == 0){
            alert("카테고리를 선택해주세요!")
            return false;
        } else {
            return true;
        }
    }

    // 입력된 카테고리 밎 지역 불러오기
    function loadSelector(selectorNode) {
        const selectorValue = selectorNode.getAttribute("value") || null
        if (selectorNode.getAttribute("value")) {
            const options = selectorNode.querySelectorAll("option");
            options[parseInt(selectorValue)].setAttribute("selected", "");
        }
    }
    loadSelector(document.querySelector("select[name=category]"));


    //지역 추가
    /*function addRegion(e) {
        const newRegion = document.getElementsByClassName("region-selection-wrapper");
        const regionNode = newRegion[0].cloneNode(true);
        regionNode.value = "";
        
        if (newRegion.length < 10) {
            const regionParent = document.getElementById('region-selection-all');
            regionParent.insertBefore(regionNode, regionParent.childNodes[regionParent.length]);
        } else {
            alert("지역은 최대 10개까지 등록할 수 있습니다.");
        }
    }

    //지역 삭제
    function delRegion(e) {
        //수정
        const regionCount = document.getElementById('region-selection-all').childElementCount;
        
        if( regionCount == 1) {
            alert("등록된 지역은 1개 이상이어야 합니다.");
        } else {
            var delConfirm = confirm("해당 지역을 삭제하시겠습니까?");
            if(delConfirm == true) {
                e.parentElement.remove();
            } else {
                alert("취소를 누르셨습니다.");
            }
        }
    }*/
    
    
</script>
{% endblock %}